# Makefile para gerenciar o projeto DBT

.PHONY: help install install-dev deps clean test run docs format lint

# Default target
help: ## Mostrar ajuda
	@echo "Comandos disponÃ­veis:"
	@grep -E '^[a-zA-Z_-]+:.*?## .*$$' $(MAKEFILE_LIST) | sort | awk 'BEGIN {FS = ":.*?## "}; {printf "\033[36m%-20s\033[0m %s\n", $$1, $$2}'

install: ## Instalar dependÃªncias de produÃ§Ã£o
	pip install -r requirements.txt

install-dev: ## Instalar dependÃªncias de desenvolvimento
	pip install -r requirements.txt
	pip install -r requirements-dev.txt
	pre-commit install

deps: ## Instalar dependÃªncias DBT
	dbt deps

clean: ## Limpar arquivos temporÃ¡rios
	dbt clean
	find . -type d -name "__pycache__" -exec rm -rf {} +
	find . -type f -name "*.pyc" -delete

test: ## Executar testes DBT
	dbt test

run: ## Executar pipeline completo
	dbt run

run-staging: ## Executar apenas modelos staging
	dbt run --select staging

docs: ## Gerar e servir documentaÃ§Ã£o
	dbt docs generate
	dbt docs serve

format: ## Formatar cÃ³digo Python
	black .
	isort .

lint: ## Verificar qualidade do cÃ³digo
	flake8 .
	black --check .
	isort --check-only .

setup: install deps ## Setup completo do projeto
	@echo "âœ… Projeto configurado com sucesso!"

dev-setup: install-dev deps ## Setup para desenvolvimento
	@echo "ðŸš€ Ambiente de desenvolvimento pronto!"
