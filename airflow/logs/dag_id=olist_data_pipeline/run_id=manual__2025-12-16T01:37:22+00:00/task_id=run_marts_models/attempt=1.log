{"timestamp":"2025-12-16T01:38:55.913375Z","level":"info","event":"DAG bundles loaded: dags-folder, example_dags","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager","filename":"manager.py","lineno":179}
{"timestamp":"2025-12-16T01:38:55.914238Z","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/olist_data_pipeline.py","logger":"airflow.models.dagbag.DagBag","filename":"dagbag.py","lineno":593}
{"timestamp":"2025-12-16T01:38:55.957324Z","level":"info","event":"Task instance is in running state","logger":"task.stdout"}
{"timestamp":"2025-12-16T01:38:55.957493Z","level":"info","event":" Previous state of the Task instance: TaskInstanceState.QUEUED","logger":"task.stdout"}
{"timestamp":"2025-12-16T01:38:55.957738Z","level":"info","event":"Current task name:run_marts_models","logger":"task.stdout"}
{"timestamp":"2025-12-16T01:38:55.957830Z","level":"info","event":"Dag name:olist_data_pipeline","logger":"task.stdout"}
{"timestamp":"2025-12-16T01:38:55.958589Z","level":"info","event":"Tmp dir root location: /tmp","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":78}
{"timestamp":"2025-12-16T01:38:55.959939Z","level":"info","event":"Running command: ['/usr/bin/bash', '-c', 'cd /opt/airflow/dbt && dbt run --select marts --profiles-dir /opt/airflow/dbt']","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":80}
{"timestamp":"2025-12-16T01:38:55.960770Z","level":"info","event":"Output:","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":92}
{"timestamp":"2025-12-16T01:38:57.955696Z","level":"info","event":"\u001b[0m01:38:57  Running with dbt=1.9.1","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":99}
{"timestamp":"2025-12-16T01:39:00.331314Z","level":"info","event":"\u001b[0m01:39:00  Registered adapter: bigquery=1.9.1","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":99}
{"timestamp":"2025-12-16T01:39:00.915642Z","level":"info","event":"\u001b[0m01:39:00  Found 15 models, 79 data tests, 9 sources, 611 macros","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":99}
{"timestamp":"2025-12-16T01:39:00.919526Z","level":"info","event":"\u001b[0m01:39:00","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":99}
{"timestamp":"2025-12-16T01:39:00.920020Z","level":"info","event":"\u001b[0m01:39:00  Concurrency: 4 threads (target='dev')","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":99}
{"timestamp":"2025-12-16T01:39:00.920382Z","level":"info","event":"\u001b[0m01:39:00","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":99}
{"timestamp":"2025-12-16T01:39:01.871280Z","level":"info","event":"\u001b[0m01:39:01  1 of 3 START sql table model marts.commercial_mart ............................. [RUN]","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":99}
{"timestamp":"2025-12-16T01:39:01.872199Z","level":"info","event":"\u001b[0m01:39:01  2 of 3 START sql table model marts.financial_mart .............................. [RUN]","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":99}
{"timestamp":"2025-12-16T01:39:01.873000Z","level":"info","event":"\u001b[0m01:39:01  3 of 3 START sql table model marts.logistical_mart ............................. [RUN]","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":99}
{"timestamp":"2025-12-16T01:39:02.109666Z","level":"info","event":"/home/airflow/.local/lib/python3.12/site-packages/dbt/adapters/bigquery/connections.py:570: FutureWarning: job_retry must be explicitly set to None if job_id is set.","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":99}
{"timestamp":"2025-12-16T01:39:02.109880Z","level":"info","event":"BigQuery cannot retry a failed job by using the exact","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":99}
{"timestamp":"2025-12-16T01:39:02.109951Z","level":"info","event":"same ID. Setting job_id without explicitly disabling","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":99}
{"timestamp":"2025-12-16T01:39:02.109997Z","level":"info","event":"job_retry will raise an error in the future. To avoid this","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":99}
{"timestamp":"2025-12-16T01:39:02.110040Z","level":"info","event":"warning, either use job_id_prefix instead (preferred) or","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":99}
{"timestamp":"2025-12-16T01:39:02.110077Z","level":"info","event":"set job_retry=None.","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":99}
{"timestamp":"2025-12-16T01:39:02.110111Z","level":"info","event":"  query_job = client.query(","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":99}
{"timestamp":"2025-12-16T01:39:02.636250Z","level":"info","event":"\u001b[0m01:39:02  BigQuery adapter: https://console.cloud.google.com/bigquery?project=olist-data-pipeline&j=bq:US:1a8fef78-c51c-45cb-a9ac-9f6a575a5b64&page=queryresults","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":99}
{"timestamp":"2025-12-16T01:39:02.648369Z","level":"info","event":"\u001b[0m01:39:02  2 of 3 ERROR creating sql table model marts.financial_mart ..................... [\u001b[31mERROR\u001b[0m in 0.77s]","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":99}
{"timestamp":"2025-12-16T01:39:06.388410Z","level":"info","event":"\u001b[0m01:39:06  3 of 3 OK created sql table model marts.logistical_mart ........................ [\u001b[32mCREATE TABLE (112.6k rows, 23.1 MiB processed)\u001b[0m in 4.51s]","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":99}
{"timestamp":"2025-12-16T01:39:07.047019Z","level":"info","event":"\u001b[0m01:39:07  1 of 3 OK created sql table model marts.commercial_mart ........................ [\u001b[32mCREATE TABLE (112.6k rows, 22.9 MiB processed)\u001b[0m in 5.17s]","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":99}
{"timestamp":"2025-12-16T01:39:07.091201Z","level":"info","event":"\u001b[0m01:39:07","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":99}
{"timestamp":"2025-12-16T01:39:07.091658Z","level":"info","event":"\u001b[0m01:39:07  Finished running 3 table models in 0 hours 0 minutes and 6.17 seconds (6.17s).","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":99}
{"timestamp":"2025-12-16T01:39:07.271843Z","level":"info","event":"\u001b[0m01:39:07","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":99}
{"timestamp":"2025-12-16T01:39:07.272370Z","level":"info","event":"\u001b[0m01:39:07  \u001b[31mCompleted with 1 error, 0 partial successes, and 0 warnings:\u001b[0m","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":99}
{"timestamp":"2025-12-16T01:39:07.272982Z","level":"info","event":"\u001b[0m01:39:07","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":99}
{"timestamp":"2025-12-16T01:39:07.273629Z","level":"info","event":"\u001b[0m01:39:07    Database Error in model financial_mart (models/marts/financial_mart.sql)","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":99}
{"timestamp":"2025-12-16T01:39:07.273680Z","level":"info","event":"  Window ORDER BY expression references column order_approved_at which is neither grouped nor aggregated at [51:34]","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":99}
{"timestamp":"2025-12-16T01:39:07.273721Z","level":"info","event":"  compiled code at target/run/olist_data_pipeline/models/marts/financial_mart.sql","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":99}
{"timestamp":"2025-12-16T01:39:07.274262Z","level":"info","event":"\u001b[0m01:39:07","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":99}
{"timestamp":"2025-12-16T01:39:07.274870Z","level":"info","event":"\u001b[0m01:39:07  Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":99}
{"timestamp":"2025-12-16T01:39:08.027159Z","level":"info","event":"Command exited with return code 1","logger":"airflow.task.hooks.airflow.providers.standard.hooks.subprocess.SubprocessHook","filename":"subprocess.py","lineno":103}
{"timestamp":"2025-12-16T01:39:08.027756Z","level":"error","event":"Task failed with exception","logger":"task","filename":"task_runner.py","lineno":986,"error_detail":[{"exc_type":"AirflowException","exc_value":"Bash command failed. The command returned a non-zero exit code 1.","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":934,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1325,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":417,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/bash.py","lineno":224,"name":"execute"}],"is_group":false,"exceptions":[]}]}
{"timestamp":"2025-12-16T01:39:08.048729Z","level":"info","event":"Task instance in failure state","logger":"task.stdout"}
{"timestamp":"2025-12-16T01:39:08.049020Z","level":"info","event":"Task start","logger":"task.stdout"}
{"timestamp":"2025-12-16T01:39:08.049158Z","level":"info","event":"Task:<Task(BashOperator): run_marts_models>","logger":"task.stdout"}
{"timestamp":"2025-12-16T01:39:08.049242Z","level":"info","event":"Failure caused by Bash command failed. The command returned a non-zero exit code 1.","logger":"task.stdout"}
